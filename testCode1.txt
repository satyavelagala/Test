
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

/*
=================================================
Created By : Reddy
Created On : 14 Jun 2022
Purpose    : to split the comma separated values
=================================================
*/
CREATE FUNCTION [dbo].[fn_split]
(
	@SplitSource Varchar(MAX)
	,@Delimiter Varchar(2)
)
RETURNS 
@MySplitData TABLE 
(
	sno varchar(2000)
)
AS
BEGIN
	Declare @TempNo int,@TempSplitSource Varchar(MAX) =''
	
	IF(RIGHT(@SplitSource,1) <> @Delimiter)
		set @SplitSource = @SplitSource + @Delimiter
	set @TempSplitSource = @SplitSource
	;with MyFormat (sno , Origname,TempName)
	as
	(
		select cast(1 as int) as sno, substring(@TempSplitSource,charindex(@Delimiter,@TempSplitSource,1)+1,len(@TempSplitSource)) as  Origname, substring(@TempSplitSource,1,charindex(@Delimiter,@TempSplitSource,1)-1) as TempName
		union all
		select sno, substring(Origname,charindex(@Delimiter,Origname,1)+1,len(Origname))  as Origname,substring(Origname,1,charindex(@Delimiter,Origname,1)-1) as TempName
		from Myformat 
		where charindex(@Delimiter,Origname,1)>0
	)	
	insert into @MySplitData (sno)
	select TempName
	from Myformat 

	RETURN 
END